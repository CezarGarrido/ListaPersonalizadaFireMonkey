unit Umain;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Graphics, FMX.Dialogs, FMX.Layouts,
  FMX.ListBox, FMX.Controls.Presentation, FMX.StdCtrls,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Error, FireDAC.UI.Intf,
  FireDAC.Phys.Intf, FireDAC.Stan.Def, FireDAC.Stan.Pool, FireDAC.Stan.Async,
  FireDAC.Phys, FireDAC.Stan.Param, FireDAC.DatS, FireDAC.DApt.Intf,
  FireDAC.DApt, Data.DB, FireDAC.Comp.DataSet, FireDAC.Comp.Client,
  FireDAC.Phys.FB, FireDAC.Phys.FBDef,
  FMX.Objects;

type
  TForm6 = class(TForm)
    Button1: TButton;
    Lista: TListBox;
    FDConexao: TFDConnection;
    QryAux: TFDQuery;
    procedure Button1Click(Sender: TObject);
  private
  itemlist: array[0..99] of TListBoxItem;
    { Private declarations }
  public
  procedure ListarMesas;
    { Public declarations }
  end;

var
  Form6: TForm6;
  campos:integer;
implementation

{$R *.fmx}

uses UFrateste;

procedure TForm6.Button1Click(Sender: TObject);
var
i:integer;
const
NamePrefix='Link';
begin

end;

procedure TForm6.ListarMesas;
var
i:integer;
const
NamePrefix='Link';
begin

   QryAux.Close;
   QryAux.SQL.Clear;
   QryAux.SQL.Add('Select * from mesas_tmp');
   QryAux.Open();
   if QryAux.RecordCount > 0 then
  begin
   campos:=QryAux.RecordCount;
    QryAux.First;
    for i:=0 to campos -1 do
     begin
     itemlist[i]:=TListBoxItem.Create(self);
     itemlist[i].Parent:=Lista;
     itemlist[i].SelecTable:=False;
     itemlist[i].ItemData.Detail:= QryAux.FieldByName('mesa').AsString;
     TFrame6.Create(self).Name:=NamePrefix + IntToStr(i);
       With TFrame6(FindComponent(NamePrefix + IntToStr(i))) do
      begin
      Parent:=itemlist[i];
      Tag:=  QryAux.FieldByName('Codigo_Int').AsInteger;

      end;
     end;
  end;
end;
end.
